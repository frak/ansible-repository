---
# File: setup.yml
# Part: Bootstrap
#
# Description: Execute basic startup tasks like refresh the apt caches
#
# Parameters:
# - bootstrap_upgrade: (bool) upgrade installed packages.
#
# Dependencies ([part:]type:filename):
#
# OS familly: Ubuntu >= 12.04

- name: Bootstrap | Update apt caches.
  command: apt-get update

- name: Bootstrap | Upgrade installed packages.
  command: apt-get upgrade -y
  when_boolean: $bootstrap_upgrade

- name: Bootstrap | Install 'python-apt' module
  command: apt-get install python-apt -y

- name: Bootstrap | Install misc utils
  apt: pkg=$item state=present
  with_items:
    - htop
    - curl
    - tmux
    - unzip
    - python-software-properties # Dependencies for the apt module
    - software-properties-common
    - acl

- name: Prepare SSH directory
  action: file dest=/home/vagrant/.ssh state=directory mode=0700

- name: Copy private key
  action: copy src=~/.ssh/id_rsa dest=/home/vagrant/.ssh/id_rsa mode=0600

- name: Copy public key
  action: copy src=~/.ssh/id_rsa dest=/home/vagrant/.ssh/id_rsa.pub

# - name: Authenticate with Github
#   shell: ssh -T git@github.com -o StrictHostKeyChecking=no 2>/dev/null